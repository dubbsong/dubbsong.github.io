---
layout: post
title: "아마존 웹 서비스를 다루는 기술"
categories: dev
tags: books
---

## 아마존 웹 서비스를 다루는 기술 - 이재홍

<br>

#### 머리말

- 가상화 기술이 발전하면서 물리적인 서버를 잘게 나눠 여러 사람이 쓸 수 있게 되었고, 한 곳에서 수많은 서버를 구입하고 운영하면서 구입 단가와 운영비는 낮아졌다.
- 이제 클릭 몇 번만 하면 저렴한 가격으로 원하는 만큼 서버를 가질 수 있게 되었다.
- 아마존 웹 서비스는 클라우드 플랫폼의 대명사로 자리 잡았다.
- 아마존 웹 서비스를 자신의 서비스 환경에 맞게 최적화한다면 어떤 서비스보다도 저렴할 것이다. 하지만, 용도에 맞지 않는 곳에 사용하거나 요금을 아끼려는 시도를 하지 않는다면 매우 비싼 서비스가 되고 만다.

<br>

## 1장 왜 AWS인가?

- IDC(데이터 센터, Internet Data Center)에 입주한다는 것은 서버를 일일이 준비한 뒤 들고 가서 서버랙에 꽂아서 사용한다는 것이다.
- 호스팅 서비스나 IDC 코로케이션 서비스는 이러한 행동을 비용을 받고 대신 해주는 것일 뿐이다.
- AWS의 장점
  - 사용한 만큼 돈을 낸다.
  - 서버 증설이 빠르다.
  - 서버 폐기도 빠르다.

<br>

### 가상화와 클라우드 컴퓨팅

- 가상 서버를 일정 사용료를 받고 서비스 형태로 제공하는 것이 클라우드 컴퓨팅이다.

<br>

### 아마존 웹 서비스

- 2006년 미국 아마존에서는 Xen 가상화 기술을 이용하여 아마존 웹 서비스(AWS)를 출시하게 된다.
- 서버 5,000대를 설치하려면 서버를 구매하는 데 3~4일, 설치하는 데 반나절, 100명이 꼬박 밤을 새도 수개월이 걸린다. AWS는 이를 획기적으로 개선했다.
- 아마존이 이렇게 많은 서버를 운영하다 보면 '규모의 경제(Economy of scale)' 효과가 발생하여 운영 비용이 점점 줄기 때문에 가격도 계속 떨어진다.
- AWS는 2014년 4월 기준으로 42번이나 가격을 인하했다.
- AWS는 IT 인프라를 제공하는 IaaS(Infrastructure as a Service)라 할 수 있다. IT 인프라를 마치 전기나 수도처럼 사용할 수 있게 된 것이다.
- AWS가 처음 나올 당시에는 가상 서버를 제공하는 EC2가 주된 기능이었다. 지금은 가상 서버뿐만 아니라 DNS, CDN, 스토리지, 데이터베이스, 빅데이터, 메시지 큐 등 IT 서비스에 필요한 모든 요소를 제공하고 있다.

<br>

### Amazon.com과 Amazon Web Service

- 아마존닷컴은 온라인 서점으로 시작하여 현재는 세계 최대의 온라인 쇼핑몰 업체이다.
- 미국에서 크리스마스 시즌과 추수감사절(블랙 프라이데이) 시즌에는 단기간에 사용자들이 폭증한다. 하지만 이 시즌이 지나면 사용자 수는 평소대로 돌아온다.
- 단기간에 서버 자원을 늘리고, 사용하지 않는 서버를 다른 곳에 쓰는 클라우드 컴퓨팅 기술은 아마존닷컴이 가장 필요로 하는 기술이다. 아마존닷컴의 필요에 의해서 개발된 이 플랫폼이 이후 AWS로 발전하게 된 것이다.
- 아마존닷컴의 경우 온라인 쇼핑몰이기 때문에 엄청난 양의 제품 사진을 제공해야 한다. 큰 용량의 이미지 파일들을 저장하고 빠르게 전송하는 플랫폼이 `S3`와 `CloudFront`이다.
- 정확한 결제와 배송 처리를 위해 `SQS`가 개발되었고, 엄청난 양의 제품 데이터를 저장하기 위해 `RDS`와 `DynamoDB`가 개발되었다.
- 사용자의 구매 패턴을 분석하기 위해 빅데이터 플랫폼인 `Data Pipeline`, `Elastic Map Reduce`, `Kinesis` 등이 개발된 것이다.

<br>

### 스타트업과 클라우드 컴퓨팅

- 자금이 부족하고, 기술 발전이 빠르며, 소수의 인원일 때는 아마존 AWS 클라우드 컴퓨팅을 이용하면 된다.
- 스타트업에 효율적인 특징
  - 혼자서 모든 인프라를 구축, 관리할 수 있다.
  - 초기 비용이 필요하지 않고, 사용한 만큼 비용을 지불한다.
  - 사업이 실패하더라도 서버 및 기타 인프라를 삭제하면 된다.
  - 서버를 늘리는 것과 부하 분산을 자동화할 수 있으므로 급격한 사용량 증가에 대응할 수 있다.

<br>

### 다양한 활용 사례

- 화성탐사로버 큐리오시티
  - NASA는 AWS의 가상 서버 EC2, ELB 로드 밸런서, DNS 서비스 Route 53, 컨텐츠 배포 서비스 CloudFront, 서버 구성을 자동화하는 CloudFormation 등을 활용하여 착륙 장면을 전 세계에 실시간으로 중계하는 데 성공했다.
- 넷플릭스
  - 넷플릭스는 자체 IDC와 서버를 운영했지만 급격히 증가하는 사용자로 인해 큰 어려움을 겪었다.
  - 결국 AWS를 활용하여 자사의 모든 서비스를 제공하고 있다.

<br>

## 2장 AWS 기본 개념

- AWS는 전 세계 주요 지역에 데이터센터(IDC)가 위치하고 있다.
- AWS를 사용하다 보면 항상 마주치게 되는 용어가 리전(Region), 가용 영역(AZ, Availability Zone)이다. 또한, CDN 서비스인 CloudFront를 사용하다 보면 에지 로케이션(Edge Location)이라는 용어를 접하게 된다.

<br>

### 리전(Region), 지역

- 리전은 AWS의 모든 서비스가 위치하고 있는 물리적인 장소이다.
- 전 세계 주요 지역에 위치하고 있으며  리전 안에는 가용 영역이 여러 개 있다.
- 리전이 여러 곳에 있는 이유는 네트워크 속도 때문이다. 아무리 네트워크 기술이 발전하고 전 세계가 광케이블로 연결되어 있더라도, 멀리 떨어진 서버에 접속하면 그만큼 경유하는 라우터 개수가 많아지므로 느려질 수밖에 없다. 따라서 주요 지역에 리전을 위치시키고 가까운 리전에 접속하게 해야 빠른 속도를 낼 수 있다.
- 리전을 여러 곳에 두는 또 다른 이유로는 큰 재해에 대비하기 위해서이다.
- 2014년 8월 기준으로 AWS는 9개의 리전을 제공
  - 미국 버지니아 북부
  - 미국 캘리포니아 북부
  - 미국 오리건
  - 아일랜드
  - 도쿄
  - 베이징
  - 싱가포르
  - 시드니
  - 상파울루
  - 미국 정부
- `us-east-1`, `ap-northeast-1`과 같은 약칭은 AWS API를 활용해 자동화하거나 명령행 인터페이스(AWS CLI)를 이용할 때 필요하므로 눈에 익혀두는 것이 좋다.

<br>

### 가용 영역

- 가용 영역(AZ, Availability Zone)은 흔히 말하는 데이터센터이다.
- AWS에서는 EC2 가상 서버를 한 리전 안에서도 여러 가용 영역에 만들어서 사용할 것을 권장하고 있다.
- 가용성은 서버, 네트워크, 프로그램 등이 정상적으로 사용 가능한 정도를 나타낸다.

<br>

### 에지 로케이션

- 에지 로케이션(Edge Location)은 AWS의 CDN 서비스인 CloudFront를 위한 캐시 서버들을 뜻한다.
- CDN 서비스는 Content Delivery Network의 약자로서, 컨텐츠(HTML, 이미지, 동영상, 기타 파일)를 사용자들이 빠르게 받을 수 있도록 전 세계 곳곳에 위치한 캐시 서버에 복제해주는 서비스이다.
- CDN 서비스는 전 세계 주요 도시에 캐시 서버를 구축해 놓는다.
- CDN 캐시 서버는 인터넷 트래픽을 효과적으로 처리할 수 있는 지역에 POP(Point-of-Presence)를 구축한다.
- CDN 서비스와 사용자가 직접 만나는 곳이라고 하여 에지(Edge)라고 부른다.

<br>

## 3장 AWS 계정 생성하기

- AWS는 기본적으로 유료서비스이지만 처음 가입하면 1년 동안 주요 AWS 리소스를 무료로 사용할 수 있는 프리 티어(Free Tier)를 제공한다.

<br>

## 4장 가상 서버를 제공하는 EC2

- EC2(Elastic Compute Cloud)는 AWS에서 가장 기본적이면서 널리 쓰이는 인프라이다.
- EC2는 인터넷에 연결된 가상 서버를 제공해준다.
- EC2를 사용해야 하는 이유는 효율성과 비용 절감에 있다.
- EC2는 클릭 몇 번으로 서버를 생성할 수 있기 때문에 실제 서버를 구축하는 것보다 훨씬 간편하고 효율적이다.
- 사용한 만큼만 요금을 지불하면 되므로 비용도 절감할 수 있다.
- 가상 서버이기 때문에 모니터에는 직접 연결할 수 없고 터미널 또는 원격 데스트탑 연결로 접속해야 한다.

<br>

#### EC2 기본 개념

- 시작(Start)
  - EC2 인스턴스를 시작한다.
  - 운영체제가 부팅되고 사용할 수 있는 상태이다.
  - 시작하는 순간부터 사용 요금이 과금되며 1분을 사용하더라도 1시간 요금으로 책정된다.
- 정지(Stop)
  - EC2 인스턴스를 정지한다.
- 삭제(Terminate)
  - EC2 인스턴스를 삭제한다.
  - 목록에서 완전히 사라지려면 시간이 조금 걸린다.
- 재부팅(Reboot)
  - EC2 인스턴스를 재부팅한다.
  - 운영체제를 종료한 뒤 다시 시작한다.
- Root 장치
  - 운영체제가 설치되는 스토리지이다.
- Kernel ID
  - EC2 인스턴스가 사용하는 Linux 커널이다.

<br>

### EC2 인스턴스 유형

- EC2에서 생성한 가상 서버를 인스턴스라고 한다.
- 서버 각각을 객체로 본다고 할 수 있다.
- 인스턴스 유형은 앞에 인스턴스 패밀리인 m에 세대(Generation)를 뜻하는 숫자가 붙고 .(점) 뒤는 전체적인 사양 규모를 뜻하는 단어가 붙는다.

<br>

#### 인스턴스 패밀리

- 범용
  - M1과 M3로 시작하는 인스턴스 유형이다.
  - vCPU, 메모리, 네트워크, 저장 공간 등이 평균적인 사양으로 제공된다.
- 컴퓨팅 최적화
  - C로 시작하는 인스턴스 유형이다.
  - 다른 인스턴스 패밀리에 비해 메모리 대비 vCPU 비율이 높다.
- GPU 인스턴스
  - G로 시작하는 인스턴스 유형이다.
  - 고성능의 NVIDIA GPU가 장착되어 있다.
- 메모리 최적화
  - M2와 CR1으로 시작하는 인스턴스 유형이다.
  - 다른 인스턴스 패밀리에 비해 메모리 용량이 훨씬 크다.
- 스토리지 최적화
  - H와 I로 시작하는 인스턴스 유형이다.
  - 다른 인스턴스 패밀리보다 스토리지 용량이 훨씬 크거나 초고속 I/O를 제공한다.
- 마이크로 인스턴스
  - 가격이 가장 싼 인스턴스이다.
  - 낮은 vCPU 성능과 적은 메모리를 제공한다.
  - 프리 티어(무료 사용 계정)에서는 이 인스턴스 유형을 무료로 사용할 수 있다.

<br>

## 5장 Security Group으로 방화벽 설정하기

- Security Group은 EC2 인스턴스에 적용할 수 있는 방화벽 설정이다.
- 서버 보안의 기본은 방화벽 설정에서 출발한다.
- 예로, Linux 서버의 접속 포트인 22번만 여는 것은 기본이고, 여기에 접속 가능한 IP 대역까지 설정하면 공격 위협이 상당히 줄어든다.

<br>

#### 방화벽 설정의 기본 요소

- Inbound
  - 외부에서 EC2 인스턴스로 들어오는 트래픽이다.
  - HTTP, HTTPS, SSH, RDP 등이 대표적이다.
- Outbound
  - EC2 인스턴스에서 외부로 나가는 트래픽이다.
  - EC2 인스턴스 안에서 인터넷을 사용할 경우 Outbound라 할 수 있다.
  - 대표적으로 파일을 다운로드하거나 외부 SSH로 접속하는 것 등이 있다.
- Type
  - 프로토콜 형태이다.
  - 프로토콜은 크게 TCP, UDP, ICMP로 나눌 수 있다.
- Port, Port Range
  - 포트 번호이다.
  - TCP, UDP vmfhxhzhfdms 0~65535 사이의 포트 번호를 사용하게 된다.
- Source/Destination
  - 연결 혹은 접속 가능한 IP 대역을 뜻한다.
  - Inbound일 경우 Source, Outbound일 경우 Destination이라 부른다.
- Rule
  - Inbound, Outbound, Type, Port, Source/Destination을 조합한 것을 Rule(규칙)이라고 한다.

<br>

## 6장 고정 IP를 제공하는 Elastic IP

- ​